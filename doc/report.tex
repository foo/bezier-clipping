\documentclass[11pt,a4paper,oneside]{report}

\usepackage[utf8]{inputenc}
\usepackage[polish]{babel}
\usepackage{polski}
\usepackage{graphics}
\usepackage{amsmath}
\usepackage{mathrsfs}

\makeatother
\title{Znajdowanie zer wielomianu w postaci Beziera za pomocą przycinania sześciennego}
\author{Maciej Pacut}
\date{Wrocław 2010}


\begin{document}
\maketitle
\newpage

\section{Wstęp}

!!!!!!!!! Wstęp napisz na końcu, powinien on opisywac , co zostanie zawarte w pracy

Jakie zastosowania ma znajdowanie zer? Szukanie przeciec krzywej z prosta. Szukanie najblizszych punktow na prostej.
Niniejsza praca daje pogląd na to, czym jest szukanie zer wielomianu i jak napisać metodę szukania zer.

\section{Numeryczne znajdowanie zer}

\subsection{Znajdowanie jednego zera}

Metoda znajdowania jednego zera funkcji dostaje argumenty:
\begin{enumerate}
\item pewien opis funkcji f, który umożliwia obliczenie wartości tej funkcji dla dowolnego argumentu
\item przedział początkowy $P_0$, czyli przedział w którym szukamy zera funkcji f; metoda nie znajdzie żadnego zera spoza tego przedziału
\item żądana dokładność $\varepsilon$ znalezienia zera funkcji f
\end{enumerate}

Metoda numerycznego znajdowania jednego zera funkcji f generuje ciąg przedziałów $\langle P_0, P_1, ..., P_n\rangle$ o własnościach:
\begin{enumerate}
\item każdy przedział jest podprzedziałem poprzedniego przedziału:
$$P_k \subset P_{k-1}\hspace{1cm}(1 \leq k \leq n)$$
\item każdy przedział zawiera zero funkcji f z przedziału $P_0$

Adnotacja na dole strony: odnosnie zbioru pustego. Jesli w przedziale P0 nie ma zera funkcji f to stwierdzenie, ze przedzial pusty (porazka) zawiera zero funkcji f z przedzialu P0 jest prawdziwe.

\item ostatni przedział $P_n$ jest pierwszym przedziałem krótszym niż $2 \varepsilon$
\end{enumerate}

Jeśli w przedziale $P_0$ metoda nie znalazła zera, to ostatnim przedziałem w ciągu jest przedział pusty; wtedy wynikiem jest brak zer. W przeciwnym przypadku wynikiem jest środek przedziału $P_n$, który jest odległy od zera funkcji f o conajwyżej $\varepsilon$. W przypadku istnienia zera w przedziale $P_0$, udało się znaleźć zero funkcji f z dokładnością $\varepsilon$.

Przedstawiony został w powyższym schemacie pewien zbiór metod znajdowania jednego zera funkcji f. Metody w tym zbiorze różnią się realizacją funkcji generującej ciąg $\langle P_0, P_1, ..., P_n\rangle$. Generowanie ciągu można opisać w postaci szukania podprzedziału $P_{k+1}$ dla danego przedziału $P_k$.

Przykładem metody znajdowania jednego zera funkcji jest bisekcja. W bisekcji przedział $P_{k+1}$ otrzymuje się dzieląc $P_k$ na pół i jako $P_{k+1}$ wybierając tę połowę, w której jest możliwość wystąpienia zera. W przypadku, gdy w żadnej połowie nie ma możliwości wystąpienia zera, $P_{k+1}$ jest przedziałem pustym i metoda kończy działanie. W przypadku, gdy w obu połowach jest możliwość wystąpienia zera, jako $P_{k+1}$ wybierana jest dowolna z połów. W bisekcji należy określić realizację operacji określającej możliwość wystąpienia zera w danym przedziale (w danej połowie przedziału $P_k$). Przykładową taką operacją jest sprawdzenie, czy funkcja f ma w końcach sprawdzanego przedziału różne znaki.

! rysunek bisekcji

W niniejszej pracy zajmiemy się inną metodą z wyżej przedstawionego zbioru metod szukania zer funkcji. Przykładem metody nie należącej do wyżej opisanego zbioru metod jest metoda Newtona. Znaczącą różnicą między metodą Newtona a metodami opisanymi wyżej jest generowanie ciągu przybliżeń zera funkcji zamiast generowania ciągu przedziałów zawierających zero.

\subsection{Znajdowanie wielu zer}

Zmodyfikujmy powyższy schemat znajdowania jednego zera. Zamiast generowania ciągu przedziałów, metoda szukania wielu zer generuje drzewo przedziałów. Drzewo przedziałów ma własności:
\begin{enumerate}
\item w korzeniu znajduje się przedział początkowy $P_0$
\item każdy potomek jest podprzedziałem swojego rodzica
\item przedział z każdego węzła zawiera zero funkcji f !! to niekoniecznie jest prawda
\item każdy liść $L$ jest pierwszym przedziałem na ścieżce od korzenia do $L$, który ma długość mniejszą niż $2 \varepsilon$
\end{enumerate}

Wynikiem jest zbiór środków niepustych przedziałów znajdujących się w liściach drzewa przedziałów.

!! Rysunek drzewa przedziałów w bisekcji przy dwóch podprzedziałach, rysunek drzewa przedziałów zdegenerowanego do listy
!! Podpis do rysunku: W wypadku 1 zera drzewo moze sie degenerowac do listy, ktora mozna traktowac jako ciąg z poprzedniego schematu.

Przedstawiony został w powyższym schemacie pewien zbiór metod znajdowania jednego zera funkcji f. Metody w tym zbiorze różnią się realizacją funkcji generującej drzewo przedziałów. Generowanie drzewa można opisać w postaci operacji znajdowania zbioru podprzedziałów (potomków) dla danego przedziału (rodzica).

Przykładem metody szukania wielu zer funkcji jest modyfikacja opisanej w poprzednim podrozdziale metody bisekcji. W przypadku gdy w obu połowach dzielonego przedziału jest możliwość wystąpienia zera, obie połowy są określane jako potomkowie przedziału.

\subsection{Szybkość metody znajdowania zer}

Szybkość znajdowania zer jest jedną z miar jakości metody. Możemy do pomiaru szybkości użyć komputera. Można zaprogramować metodę szukania zer w pewnym ustalonym języku programowania, za pomocą ustalonego kompilatora i uruchomić ją na komputerze z ustalonym procesorem, ustaloną hierarchią pamięci, na ustalonym systemie operacyjnym, na którym pracują równolegle ustalone programy i podać na wejście programowi ustaloną funkcję, której zer szukamy i ustaloną dokładność. Czas, który upłynął od podania danych do otrzymania wyniku można traktować jako szybkość działania metody. To podejście ma pewne wady, takie jak testowanie metody na skończonej liczbie funkcji oraz brak możliwości powtórzenia eksperymentu w dokładnie tych samych warunkach. Jednak jest to pomiar łatwy do wykonania i dający pewne wskazówki co do szybkości działania metody.

Zamiast mierzenia czasu możemy zmierzyć liczbę operacji zmiennoprzecinkowych, które wykonano znajdując zera konkretnej funkcji. To podejście wyklucza wiele czynników, biorących udział w poprzednim pomiarze. Przykładowo, pomijane są realizacje operacji przydziału i zwalniania pamięci, wczytywania danych i wypisywania wyników. Zyskujemy możliwość porównywania metod znajdowania zer przez uruchamianie ich na tych samych danych, lecz na innych komputerach. Jednakże, wciąż jesteśmy ograniczeni do testowania na skończonej liczbie funkcji. 

Lepsze metody zostały wymyślone. Możemy rozpatrzyć zależności między kolejnymi przedziałami dla dowolnej funkcji analizując operację znajdowania następnika przedziału w ciągu lub potomków przedziału w drzewie przedziałów. Posługujemy się pojęciem rzędu zbieżności, czyli miarą tego, ile krótszy jest następny wygenerowany przedział od poprzedniego. Oznaczając długość $k$-tego przedziału w ciągu jako $e_k$ metoda ma rząd zbieżności p, gdy:

$$e_k^p \sim e_{k+1}$$

Biorąc pod uwagę, że przedziały nie mogą mieć ujemnej długości, że zależność może się stabilizować dopiero od pewnego kroku, oraz że analizowana metoda powinna być zbieżna, mamy rząd zbieżności 1 gdy:

$$\lim_{k \rightarrow \inf}\frac{e_{k+1}}{e_k} = u\hspace{1cm}0<u<1$$

oraz rząd zbieżności $p$, $p>1$, gdy:

$$\lim_{k\rightarrow\inf}\frac{e_{k+1}}{e_k^p} = u\hspace{1cm}u>0$$

Przykładowo. bisekcja ma rząd zbieżności 1, gdyż następny przedział jest połową poprzedniego:

\begin{equation}
\begin{cases}
e_{k+1}=\frac{1}{2}e_k \\
\lim_{k \rightarrow \inf}\frac{e_{k+1}}{e_k}=\frac{1}{2}
\end{cases}
\end{equation}

Musimy takze uwzględnić, ile operacji zostało wykonanych, aby wygenerowac nastepny przedzial. Bierzemy pod uwage tylko niektore operacje, tj. obliczenie wartosci funkcji w punkcie czy obliczenie pochodnej, reszte operacji traktujac jako tanie.

PRzykladowo, jesli porownujemy dwie metody, z ktorej jedna wymaga obliczenia funkcji w krancach poprzedniego przedzialu i pochodnej wewnatrz i nastepny przedzial jest krotszy 3-krotnie oraz mamy metode, ktora wymaga jedynie obliczenia pochodnej i przedzial jest 2-krotnie mniejszy to 3/3 = 1 a 2/1 = 2 i druga metoda jest lepsza.

W przypadku wielu zer drzewo rozwijane jest tak, ze w jednym kroku (dla jednej ewaluacji) rozwijana jest tylko jedna gałąź, dlatego ignorujemy kroki pracujace nad innymi zerami.



Przykładowo, bisekcja ma zbieżność liniową. O zbieznosci liniowej i dodatkowemu wymaganiu na zbieznosc linowa - stala musi byc mniejsza od jednosci, gdyz inaczej metoda bylaby rozbiezna - kolejny przedzial bylby wiekszy od poprzedniego!

\section{Znajdowanie zer wielomianów}

\subsection{Zera wielomianów stopnia niższego niż 5}

Istnieją wzory analityczne na zera wielomianów niskiego stopnia

Wzory na zera 2 i 3 napisac, 4 wspomniec ze są.

Poprawianie wzorow. Wzory Viete'a. Dodatkowy krok metody newtona.

\subsection{Zera wielomianów dowolnego stopnia}

* Wyższego stopnia nalezy szukac numerycznie
** http://mathworld.wolfram.com/AbelsImpossibilityTheorem.html

Znajdowanie zer wielomianów nie jest jednak tak ogólnym zadaniem jak znajdowanie zer funkcji ciągłych. Możemy skorzystać z weilu własności wielomianów.

Gdy mamy informację, że funkcja, której zer szukamy jest wielomianem, możemy skorzystać z własności wielomianów do:
* przyspieszenia metody
* upewnienia się, że znajdujemy wszystkie zera
** ograniczenie na liczbę zer rzeczywistych - stopień
** ustalenie pewnego przyblizenia poczatkowego
** ciągłość 0..stopien-1 pochodnych



\section{Wielomiany w postaci Beziera}

!! wiadomosci z ponizszego paragrafu powiniennes potwierdzic źródłami albo chociaz sprawdzic ich poprawnosc w jakims podreczniku.

Zbiór wielomianów stopnia nie większego niż $n$ jest przestrzenią wektorową o wymiarze $n$. Każda przestrzeń liniowa ma nieskończoną liczbę baz. Jedną z baz wielomianów jest baza potęgowa ${1,x,x^2,x^3,...,x^n}$. Inną bazą jest baza Bernsteina ${B^n_0(x),...,B^n_n(x)}$, gdzie $B^n_i(x) = (n po k)x^i(1-x)^i$. Wielomian wyrażony w bazie Bernsteina nazywany jest wielomianem w postaci Beziera. Każdy wielomian w bazie potęgowej $P(x) = \sum^n_{i=0}p_i x^i$ można przedstawić w bazie Bernsteina $P(x) = \sum^n_{i=0}b_i B^n_i(x)$. Zależność między wektorem $p = <p_0,...,p_n>$ a wektorem $b = <b_0, ..., b_n$ w formie $p [ m_{ij} ] = b$ nazywana jest macierzą konwersji albo macierzą przejścia.

Postać Beziera ma inne własności niż postać potęgowa. W jednych zastosowaniach sprawdza się postać potęgowa, w innych postać Beziera, w innych sprawdzają się jeszcze inne bazy. Przykładowym zastosowaniem postaci Beziera jest grafika komputerowa. Zgodnie z tw. Weierstrassa (udowodnionym zresztą przy pomocy wielomianów w bazie Bernsteina) krzywa parametryczna opisana parą wielomianów może odwzorowywać dowolny kształt ciągły z dowolną dokładnością. Specjalne krzywe wielomianowe, krzywe, których wielomiany są opisane w postaci Beziera dają łatwość kształtowania krzywej. Związek współczynników Beziera wielomianów opisujących krzywą jest wizualnie powiązany z kształtem krzywej. Pozwala to ludziom nie znającym matematyki !! (bardzo niefajne okreslenie) używać potężnego narzędzia jakim są krzywe parametryczne do konstrukcji kształtów. Krzywe i powierzchnie parametryczne są potężnym narzędziem, gdyż są opisane wektorowo a nie rastrowo, dzięki czemu pozwalają na łatwą (effortless, bezwysiłkową?), bez modyfikacji kazdego piksela modyfikację istniejących kształtów oraz pozwalają na przekształcenia tj. przesunięcie, obrót i skalowanie.

!! rysunek wielomianu w postaci Beziera wraz z punktami kontrolnymi
!! rysunek krzywej
!! rysunek powierzchni

Powodem powiązania geometrycznego postaci Bezier z jej wykresem jest jej własność otoczki wypukłej. Krótki dowód przez kombinację wypukłą.

!! rysunek otoczki wypuklej

\section{Znajdowanie zer wielomianu w postaci Beziera}

Przecięcie {krzywa,powierzchnia}-prosta jest problemem, który sprowadza się do znajdowania zera wielomianu w formie Beziera. Problem ten występuje np. w ray-tracingu, czyli wyświetlaniu sceny oświetlonej techniką śledzenia promieni w scenie, której obiekty są powierzchniami w postaci Beziera. Krótkie przedstawienie tej redukcji.

Pomysly na szukanie zer. Pierwszy pomysl to obliczenie macierzy przejscia (wspomnienie, ze efektywne algorytmy wymagaja czasu proporcjonalnego liniowo do stopnia, gdyz macierz przejscia jest wstęgowa). Jednakze, lepsze metody istnieją. Wykorzystują one pewne własności postaci Beziera.

* Dzielenie przedziału. Algorytm de Casteljau. Poddziedzina. Rozszerzona definicja wielomianu Beziera ze względu na dziedzinę.

Metoda bezclip. Aby zdefiniowac bezclip wystarczy zdefiniowac znajdowanie potomkow przedzialu w drzewie przedzialu. PRZecięcie otoczki wypuklej punktow kontrolnych wielomianu z osią OX oraz ew. dzielenie na 2 czesci.

!! Dlaczego na 2 czesci? Bo rzad zbieznosci jest 2. Czy to stwierdzenie jest prawdziwe i czy metode, ktora ma rzad zbieznosci 3 najlepiej podzielic na wiecej czesci?

!! rysunek kolejnych otoczek wypuklych

Szybkosc metody bezclip.

Wykorzystujemy właściwości wielomianu: podziedziena (do nowej otoczki wypuklej)

\section{Aproksymacja wielomianu wielomianem}

Aproksymacja to utworzenie uproszczonego modelu, ktory daje pewne informacje o oryginale i jest latwiejszy do przetworzenia. Tutaj bedziemy aproksymowac wielomian wysokiego stopnia, ktorego zer nie mozna okreslic analitycznie wielomianem stopnia nieskiego, ktorego zera mozemy okreslic analitycznie. Musimy takze okreslic, jak zera wielomianu niskiego stopnia roznia sie od zer oryginalnego wielomianu.

Przyblizenie wielomianu wysokiego stopnia wielomianem niskiego stopnia. ``Redukcja stopnia''. 

Aproksymujac wielomian upraszczamy go, tracac informacje (punkty krańcowe, ) ale jednoczesnie zyskujac mozliwosc latwiejszego przetwarzania go.

Macierz redukcji. Obliczanie macierzy redukcji metodą Lewanowicza-Woźnego.

\section{n-clip}

Dzięki skorzystaniu z dalszych własności wlasnosci postaci Beziera: 
* Maksymalna różnica między wielomianami dzięki łatwemu obliczaniu normy maksymalnej wielomianu różnicy.
* Podnoszenie stopnia.

Dwa wielomiany ograniczające.

Wykorzystuje fakt, ze funkcja, ktorej zer szukamy jest wielomianem. Wykorzystujemy takze pewne wlasnosci wielomianow Beziera tj. podzial wielomianu w punkcje czy poddziedzina. (Potrzebne jest to przy wielokrotnym wykorzystaniu tej samej macierzy redukcji, zauwazmy rozwniez, ze po znalezieniu pierwszego zera nie warto szukac zer wielomianu P(x)/(x-r0), gdyz nie mozna wykorzystac tej samej macierzy redukcji)

\subsection{cubiccliping}

\subsection{podsumowanie}

!! na koncu

\section{Dodatek 1: Operacje na przedziałach}

- odejmowanie przedziałów od siebie



\begin{center}
\begin{figure}
\includegraphics{../tests/between2/graph.pdf}
\end{figure}
\end{center}


\end{document}